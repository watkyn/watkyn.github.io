
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Pattern of the Week - Visitor - ...</title>
  <meta name="author" content="Tony Eichelberger">

  
  <meta name="description" content="The intent of VISITOR is to let you define a new operation for a hierarchy without changing the hierarchy classes. (Java Design Patterns)Josh &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://watkyn.github.io/blog/2010/01/06/Pattern-of-the-week-Visitor">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="..." type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">...</a></h1>
  
    <h2>(That is an ellipsis)</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:watkyn.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Pattern of the Week - Visitor</h1>
    
    
      <p class="meta">
        








  



  
<time datetime="2010-01-06T17:05:07-06:00" pubdate data-updated="true">Jan 6<span>th</span>, 2010</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>The intent of VISITOR is to let you define a new operation for a hierarchy without changing the hierarchy classes. (Java Design Patterns)<br /><br />Josh Kerievsky puts it this way, &ldquo;The job of many real world Visitors is to accumulate information.&rdquo;<br /><br />So what exactly does that mean in practice?  The classes in the hierarchy must have a method called accept() that takes in an specified interface.  Then the interface will have visit() methods on there.  The visit signature will be determined by which class in the hierarchy you want to visit, and thus extend functionality to.<br /><br />The tricky part for me to understand was the &ldquo;double-dispatch&rdquo; that needs to take place for Visitor to function.  An object that conforms to the interface needed by the visitor takes the visitor in the accept() method.  Inside the accept() method the visit method is called by the object which then passes itself to the correct visit() method of the Visitor.<br /><br />Confusing?  Yes, it seems to be rather.<br /><br />I like the quote by Ralph Johnson about Visitor, &ldquo;Most of the time you don&rsquo;t need Visitor, but when you do need Visitor, you really need Visitor!&rdquo;<br /><br />That tells me, to not go out of my way to find uses for Visitor, but to stay far away from it until the light bulb comes on in a particular project where this makes perfect sense.  It may never happen, in which case I won&rsquo;t lose any sleep.<br /><br /><br />Visitor does not apply to ruby or any dynamic language where you can change the class hierarchy whenever you wish, on the fly.  Even so, I am going to show this code in ruby, pretending to be Java.  The interesting thing here is that ruby does not have method overloading since it is dynamically types.  So the actual java example would look different, in that the visit methods would be overloaded with the different types that we know of.  The ruby example has to check inside the visit method for the appropriate type and handle it accordingly.  Method overloading is a nice thing to have when you want it.<br /><br />My <a href="http://github.com/watkyn/scripts/blob/master/patterns/visitor.rb">TreeVisitor</a> example in ruby.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Tony Eichelberger</span></span>

      








  



  
<time datetime="2010-01-06T17:05:07-06:00" class="updated">Updated Jan 6<span>th</span>, 2010</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/patterns/'>patterns</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2009/12/03/Learn-4-to-6-editors-adequately/" title="Previous Post: Learn 4 to 6 editors adequately">&laquo; Learn 4 to 6 editors adequately</a>
      
      
        <a class="basic-alignment right" href="/blog/2010/01/11/Legacy-Code-Extract-Interface/" title="Next Post: Legacy Code - Extract Interface">Legacy Code - Extract Interface &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/02/22/The-developer-mind-and-QA/">The Developer Mind and QA</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/14/SVN-Eclipse-Mountain-Lion-and-Homebrew/">SVN Eclipse Mountain Lion and Homebrew</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/01/06/Updating-rubygems-on-an-old-10.5-Leopard-machine/">Updating Rubygems on an Old 10.5 Leopard Machine</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/01/06/vim-compiled-with-ruby-support-on-Lion/">Vim Compiled With Ruby Support on Lion</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/09/22/Using-git-at-work-on-a-Windows-network-drive/">Using Git at Work on a Windows Network Drive</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Tony Eichelberger -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  











</body>
</html>
